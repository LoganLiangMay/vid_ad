(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92923,38675,e=>{"use strict";var t=e.i(56808),r=e.i(31272),a=e.i(26151);function n(e,t){let r={};for(let a in e)e.hasOwnProperty(a)&&(r[a]=t(e[a]));return r}function i(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e)||!0===e||!1===e||"[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>i(e));if("function"==typeof e||"object"==typeof e)return n(e,e=>i(e));throw Error("Data cannot be encoded in JSON: "+e)}function s(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{let t=Number(e.value);if(isNaN(t))throw Error("Data cannot be decoded from JSON: "+e);return t}default:throw Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>s(e)):"function"==typeof e||"object"==typeof e?n(e,e=>s(e)):e}let o="functions",l={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class c extends r.FirebaseError{constructor(e,t,r){super(`${o}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,c.prototype)}}function u(e,t){let r,a=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),n=a;try{let e=t&&t.error;if(e){let t=e.status;if("string"==typeof t){if(!l[t])return new c("internal","internal");a=l[t],n=t}let i=e.message;"string"==typeof i&&(n=i),r=e.details,void 0!==r&&(r=s(r))}}catch(e){}return"ok"===a?null:new c(a,n,r)}class d{constructor(e,r,a,n){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,t._isFirebaseServerApp)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=r.getImmediate({optional:!0}),this.messaging=a.getImmediate({optional:!0}),this.auth||r.get().then(e=>this.auth=e,()=>{}),this.messaging||a.get().then(e=>this.messaging=e,()=>{}),this.appCheck||n?.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return e?.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){let t=await this.getAuthToken();return{authToken:t,messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}let h="us-central1",m=/^data: (.*?)(?:\n|$)/;class p{constructor(e,t,r,a,n=h,i=(...e)=>fetch(...e)){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new d(e,t,r,a),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(n);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=h}catch(e){this.customDomain=null,this.region=n}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;if(null!==this.emulatorOrigin){let r=this.emulatorOrigin;return`${r}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function g(e){return e.emulatorOrigin&&(0,r.isCloudWorkstation)(e.emulatorOrigin)?"include":void 0}async function f(e,t,r,a,n){let i;r["Content-Type"]="application/json";try{i=await a(e,{method:"POST",body:JSON.stringify(t),headers:r,credentials:g(n)})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}async function w(e,t){let r={},a=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return a.authToken&&(r.Authorization="Bearer "+a.authToken),a.messagingToken&&(r["Firebase-Instance-ID-Token"]=a.messagingToken),null!==a.appCheckToken&&(r["X-Firebase-AppCheck"]=a.appCheckToken),r}async function y(e,t,r,a){var n;let o,l={data:r=i(r)},d=await w(e,a),h=(n=a.timeout||7e4,o=null,{promise:new Promise((e,t)=>{o=setTimeout(()=>{t(new c("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{o&&clearTimeout(o)}}),m=await Promise.race([f(t,l,d,e.fetchImpl,e),h.promise,e.cancelAllRequests]);if(h.cancel(),!m)throw new c("cancelled","Firebase Functions instance was deleted.");let p=u(m.status,m.json);if(p)throw p;if(!m.json)throw new c("internal","Response is not valid JSON object.");let g=m.json.data;if(void 0===g&&(g=m.json.result),void 0===g)throw new c("internal","Response is missing data field.");return{data:s(g)}}async function v(e,t,r,a){var n,o,l,d;let h,p,f,y,v,A={data:r=i(r)},T=await w(e,a);T["Content-Type"]="application/json",T.Accept="text/event-stream";try{f=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(A),headers:T,signal:a?.signal,credentials:g(e)})}catch(t){if(t instanceof Error&&"AbortError"===t.name){let e=new c("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let e=u(0,null);return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}let k=new Promise((e,t)=>{y=e,v=t});a?.signal?.addEventListener("abort",()=>{let e=new c("cancelled","Request was cancelled.");v(e)});let S=(n=f.body.getReader(),o=y,l=v,d=a?.signal,h=(e,t)=>{let r=e.match(m);if(!r)return;let a=r[1];try{let e=JSON.parse(a);if("result"in e)return void o(s(e.result));if("message"in e)return void t.enqueue(s(e.message));if("error"in e){let r=u(0,e);t.error(r),l(r);return}}catch(e){if(e instanceof c){t.error(e),l(e);return}}},p=new TextDecoder,new ReadableStream({start(e){let t="";return r();async function r(){if(d?.aborted){let t=new c("cancelled","Request was cancelled");return e.error(t),l(t),Promise.resolve()}try{let{value:a,done:i}=await n.read();if(i){t.trim()&&h(t.trim(),e),e.close();return}if(d?.aborted){let t=new c("cancelled","Request was cancelled");e.error(t),l(t),await n.cancel();return}let s=(t+=p.decode(a,{stream:!0})).split("\n");for(let r of(t=s.pop()||"",s))r.trim()&&h(r.trim(),e);return r()}catch(r){let t=r instanceof c?r:u(0,null);e.error(t),l(t)}}},cancel:()=>n.cancel()}));return{stream:{[Symbol.asyncIterator](){let e=S.getReader();return{async next(){let{value:t,done:r}=await e.read();return{value:t,done:r}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:k}}let A="@firebase/functions",T="0.13.1";function k(e=(0,t.getApp)(),a=h){let n=(0,t._getProvider)((0,r.getModularInstance)(e),o).getImmediate({identifier:a}),i=(0,r.getDefaultEmulatorHostnameAndPort)("functions");return i&&S(n,...i),n}function S(e,t,a){var n;let i;n=(0,r.getModularInstance)(e),i=(0,r.isCloudWorkstation)(t),n.emulatorOrigin=`http${i?"s":""}://${t}:${a}`,i&&((0,r.pingServer)(n.emulatorOrigin+"/backends"),(0,r.updateEmulatorBanner)("Functions",!0))}function I(e,t,a){var n;let i;return n=(0,r.getModularInstance)(e),(i=e=>{var r,i,s,o;let l;return r=n,i=t,s=e,o=a||{},l=r._url(i),y(r,l,s,o)}).stream=(e,r)=>{var a,i,s,o;let l;return a=n,i=t,s=e,o=r,l=a._url(i),v(a,l,s,o||{})},i}function E(e,t,a){var n;let i;return n=(0,r.getModularInstance)(e),(i=e=>y(n,t,e,a||{})).stream=(e,r)=>v(n,t,e,r||{}),i}(0,t._registerComponent)(new a.Component(o,(e,{instanceIdentifier:t})=>new p(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("messaging-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,t.registerVersion)(A,T,void 0),(0,t.registerVersion)(A,T,"esm2020"),e.s(["FunctionsError",()=>c,"connectFunctionsEmulator",()=>S,"getFunctions",()=>k,"httpsCallable",()=>I,"httpsCallableFromURL",()=>E],38675),e.s([],92923)},88236,e=>{"use strict";var t=e.i(89589),r=e.i(59694);e.i(64752);var a=e.i(66870),n=e.i(39555);e.i(59539);var i=e.i(22008);let s=(0,r.createContext)(void 0);function o(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function l({children:e}){let[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(!0),[m,p]=(0,r.useState)(null),g=async(e,t)=>{if(!e)return;let r=(0,i.doc)(n.firestore,"users",e.uid),a=await (0,i.getDoc)(r);if(a.exists()){await (0,i.updateDoc)(r,{lastLogin:(0,i.serverTimestamp)()});let t=a.data();u({uid:e.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,createdAt:t.createdAt?.toDate(),lastLogin:t.lastLogin?.toDate(),metadata:t.metadata})}else{let a={uid:e.uid,email:e.email,displayName:e.displayName||t?.displayName||null,photoURL:e.photoURL,createdAt:new Date,lastLogin:new Date,...t};try{await (0,i.setDoc)(r,{...a,createdAt:(0,i.serverTimestamp)(),lastLogin:(0,i.serverTimestamp)()}),u(a)}catch(e){console.error("Error creating user profile:",e),p("Failed to create user profile")}}},f=async(e,t,r)=>{p(null);try{let i=await (0,a.createUserWithEmailAndPassword)(n.auth,e,t);return r&&i.user&&await (0,a.updateProfile)(i.user,{displayName:r}),await g(i.user,{displayName:r}),i}catch(e){throw p(e.message),e}},w=async(e,t,r=!1)=>{p(null);try{await (0,a.setPersistence)(n.auth,r?a.browserLocalPersistence:a.browserSessionPersistence);let i=await (0,a.signInWithEmailAndPassword)(n.auth,e,t);return i.user&&(await g(i.user),r&&localStorage.setItem("sessionStartTime",new Date().toISOString())),i}catch(e){throw p(e.message),e}},y=async()=>{p(null);try{{let e=new URLSearchParams(window.location.search).get("returnUrl")||"/dashboard";localStorage.setItem("authRedirectUrl",e)}let e=new a.GoogleAuthProvider;e.addScope("profile"),e.addScope("email"),await (0,a.signInWithRedirect)(n.auth,e)}catch(e){throw p(e.message),e}},v=async()=>{p(null);try{{let e=new URLSearchParams(window.location.search).get("returnUrl")||"/dashboard";localStorage.setItem("authRedirectUrl",e)}let e=new a.OAuthProvider("apple.com");await (0,a.signInWithRedirect)(n.auth,e)}catch(e){throw p(e.message),e}},A=async()=>{p(null);try{await (0,a.signOut)(n.auth),u(null),localStorage.removeItem("sessionStartTime")}catch(e){throw p(e.message),e}},T=()=>{let e=localStorage.getItem("sessionStartTime");if(e&&o){let t=new Date(e);(new Date().getTime()-t.getTime())/864e5>30&&(A(),p("Your session has expired after 30 days. Please log in again."))}},k=async e=>{p(null);try{await (0,a.sendPasswordResetEmail)(n.auth,e)}catch(e){throw p(e.message),e}},S=async e=>{if(!o)return void p("No user logged in");p(null);try{let t=(0,i.doc)(n.firestore,"users",o.uid);await (0,i.updateDoc)(t,e),u(t=>t?{...t,...e}:null),(void 0!==e.displayName||void 0!==e.photoURL)&&await (0,a.updateProfile)(o,{displayName:e.displayName||o.displayName,photoURL:e.photoURL||o.photoURL})}catch(e){throw p(e.message),e}};return(0,r.useEffect)(()=>{let e=!0,t=setTimeout(()=>{e&&d&&(console.warn("Auth initialization timed out, setting loading to false"),h(!1))},5e3);(async()=>{try{let e=await (0,a.getRedirectResult)(n.auth);e&&e.user&&(console.log("âœ… OAuth redirect successful, user:",e.user.email),g(e.user).catch(e=>{console.error("Error creating user profile:",e)}),localStorage.setItem("sessionStartTime",new Date().toISOString()),localStorage.setItem("oauthSuccess","true"))}catch(e){console.error("OAuth redirect error:",e),p(e.message||"Failed to sign in with OAuth provider")}})();let r=(0,a.onAuthStateChanged)(n.auth,async r=>{if(e){if(l(r),r){let e=(0,i.doc)(n.firestore,"users",r.uid);try{let t=await (0,i.getDoc)(e);if(t.exists()){let e=t.data();u({uid:r.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,createdAt:e.createdAt?.toDate(),lastLogin:e.lastLogin?.toDate(),metadata:e.metadata})}else g(r).catch(e=>{console.error("Error creating user profile in auth listener:",e)});T()}catch(e){console.error("Error fetching user profile:",e)}}else u(null);h(!1),clearTimeout(t)}}),s=setInterval(()=>{T()},36e5);return()=>{e=!1,clearTimeout(t),r(),clearInterval(s)}},[]),(0,t.jsx)(s.Provider,{value:{currentUser:o,userProfile:c,loading:d,error:m,signup:f,login:w,loginWithGoogle:y,loginWithApple:v,logout:A,resetPassword:k,updateUserProfile:S,clearError:()=>p(null),checkSessionExpiry:T},children:e})}e.s(["AuthProvider",()=>l,"useAuth",()=>o])}]);